<html>
<head>
    <title>Dashboard</title>
    <meta name="theme-color" content="#333333" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" type="text/css" href="css/dashboard.css" />
    <link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="css/weather.css">
    <link rel="stylesheet" type="text/css" href="css/calendar.css">
</head>
<!-- Redirects page if no auth cookie is found (ajax calls will fail if no cookie is found) -->
<script>
    if (document.cookie.indexOf('authToken') == -1 ) {
        window.location.href='/login';
    }
</script>
<script type='text/javascript' src='js/knockout.js'></script>

<body>
    <div id="WeatherWrapper" data-bind="with: WeatherListVM">
        <div id="WeatherList" data-bind="foreach: WeatherList">
            <div class="WeatherElement">
                <div data-bind="attr: { id: 'WeatherElement'+$index() }"></div>
                <div class="weatherFooter">
                    <label data-bind="text: Day"></label>
                    <br>
                    <label data-bind="text: Min"></label>
                    <label> - </label>
                    <label data-bind="text: Max"></label>
                    <br>
                    <label data-bind="text: Description"></label>
                </div>
            </div>
        </div>
        
        <div data-bind="foreach: WeatherDetails">
            <div class="WeatherDetails">
                <div data-bind="attr: { id: 'WeatherDetails'+$index() }" class="WeatherDetailsIcon">
                </div>
                <div class="DetailsDivider" data-bind='html: Intensity'></div>
                <div class="WeatherContentWrapper">
                    <ul class="WeatherDetailsContentLeft">
                        <label>Summary</label>
                        <li data-bind="text: summary"></li>
                        <label>Min</label>
                        <li><span data-bind="text: temperatureMin"></span>&#8457; </li>
                        <label>Max</label>
                        <li><span data-bind="text: temperatureMax"></span>&#8457; </li>
                    </ul>
                    <ul class="WeatherDetailsContentRight">
                        <label>Humidity</label>
                        <li><span data-bind="text: Math.floor(humidity*100)"></span>%</li>
                        <label>Cloud Cover</label>
                        <li><span data-bind="text: Math.floor(cloudCover*100)"></span>%</li>
                        <label>Chance of Rain</label>
                        <li><span data-bind="text: Math.floor(precipProbability*100)"></span>%</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div id="ToDoWrapper">
        <div id="ToDoList" data-bind="with: ToDoListVM">
            <div data-bind="foreach: ToDoList">
                <div class="ToDoElement" data-bind="attr: { id: Order }, css: { done: Completed }" draggable="true">
                    <div class="ToDoContentWrapper">
                        <span class="ToDoContent" spellcheck="false" data-bind="text: Content, attr: { id: Id }" contenteditable="true" onKeyPress="return checkEdit(event)"></span>
<span class="ToDoTime" data-bind="text: Time"></span>
                    </div>
                    
                    <div class="IconWrapper">
                        <div class="modifyIcon">                        
                            <i class="fa fa-check" aria-hidden="true" data-bind="click: finishToDo"></i>
                            <i class="fa fa-undo" aria-hidden="true" data-bind="click: finishToDo"></i>
                        </div>
                       <div class="deleteIcon">
                            <i class="fa fa-times" aria-hidden="true" data-bind="click: deleteToDo"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="inputWrapper">
            <input type="text" id="textBox" onKeyPress="return checkSubmit(event)">
        </div>
    </div>

    <div id="calendarWrapper">
        <div class="calendar">
            <div class="group">
                <p class="left pointer minusmonth">&#9666;</p>
                <p class="monthname center"></p>
                <p class="right pointer addmonth">&#9656;</p>
            </div>
            <ul class="group">
            </ul>
        </div>
        <div id="eventContainer">
            <h3 id="SelectedDay">Sunday</h3>
            <ul id="eventList" data-bind="foreach: EventListVM.FilteredEvents">
                <li data-bind="text: Content">No Content</li>
            </ul>
            <div id="eventInputWrapper">
                <input type="text" id="eventInput" onKeyPress="return checkEventSubmit(event)">
            </div>
        </div>
    </div>
</body>
<script>
    // Defines a service worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js');
      });
    }    
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
<script async type='text/javascript' src='js/dashboard.js'></script>
<script async type='text/javascript' src='js/calendar.js'></script>
<script async type='text/javascript' src='js/drag.js'></script>
</html>